<h1 align="center">
    🌐 webserv
</h1>

<h3 align="center">
	<a href="#-about-the-project">프로젝트 소개</a>
	<span> · </span>
	<a href="#%EF%B8%8F-usage">사용법</a>
</h3>

## 📘 프로젝트 소개

`webserv`는 **HTTP/1.1** 프로토콜을 준수하는 웹 서버를 **C++98**로 구현하는 프로젝트입니다. 이 프로젝트는 **I/O 멀티플렉싱**과 **비동기 소켓 통신**의 개념을 바탕으로 실제 웹 서버의 동작 원리를 이해하고 구현하는 데 중점을 두고 있습니다.

## 💡 주요 목표

- **HTTP/1.1 구현**: GET, POST, DELETE 메소드 지원
- **I/O 멀티플렉싱**: `poll()`을 사용하여 여러 클라이언트 연결을 동시에 처리
- **정적 웹사이트 서비스**: HTML 페이지를 제공하는 정적 웹사이트 서비스
- **다중 포트 리스닝**: 여러 포트에서 동시 요청 처리
- **비동기 소켓 통신**: 소켓 비동기 처리를 통해 서버 성능 향상

## 📂 주요 개념

| 개념 | 설명 |
|:------------|:------------|
| `I/O 멀티플렉싱` | `poll()` 또는 `kqueue()`를 이용해 여러 클라이언트의 요청을 비동기적으로 처리 |
| `비동기 소켓 통신` | 블로킹 없이 데이터를 송수신하여 서버가 여러 작업을 동시에 처리할 수 있게 함 |
| `HTTP/1.1` | 웹 서버가 클라이언트 요청을 처리할 때 사용하는 프로토콜로, 지속 연결, 파이프라이닝, 쿠키 등을 지원 |
| `비동기 처리` | 클라이언트 요청을 처리하는 동안 서버가 블로킹되지 않고 다른 작업을 수행할 수 있는 기술 |
| `Nginx 유사 설정` | Nginx와 유사한 구조의 설정 파일 파싱 및 처리 |

## 📊 주요 기능

### 1. **비동기 I/O 멀티플렉싱 기반 아키텍처**
`poll()`를 사용해 서버는 여러 클라이언트 소켓과 이벤트를 감시하며, 이벤트 발생 시 처리하는 구조로 설계되었습니다. 이를 통해 비동기적으로 다수의 클라이언트를 효율적으로 처리합니다.

### 2. **Nginx 스타일 설정 파일**
서버 설정은 Nginx와 유사하게 `.conf` 파일을 기반으로 이루어집니다. 설정 파일을 파싱하여 여러 포트 리스닝, 라우팅, 에러 페이지 설정 등을 처리합니다.

```conf
http {
    error_page 404 500 413 ./www/error/default.html;
    index index.html ;
    autoindex on;
    server {
        listen 4000;
        location / {
            alias ./www/example/;
            limit_except POST GET DELETE;
        }
        location /box/ {
            limit_except GET;
        }
    }
    server {
        listen 42;
        client_max_body_size 100;
        location / {
            alias ./www/example/;
        }
    }
}
```

### 3. **HTTP/1.1 구현**
GET, POST, DELETE 메소드 지원과 함께 HTTP 파이프라이닝 및 쿠키 처리를 구현했습니다.

### 4. **다중 포트 리스닝**
서버는 여러 포트에서 동시에 리스닝할 수 있으며, 각 포트에 대해 개별 설정을 적용할 수 있습니다.

## 🧠 프로그램 동작

### 1. **프로그램 실행 방법**

다음 명령어를 사용하여 `webserv`를 실행할 수 있습니다:

```bash
./webserv configs/example.conf
```

### 2. **출력**

서버가 실행되면 클라이언트 요청을 처리하는 로그가 출력됩니다.

```bash
Client connected on port 4000
GET /index.html HTTP/1.1
```

## 🛠️ 주요 함수 및 기능

### 1. **핵심 함수**

- **poll()**: 여러 파일 디스크립터를 감시하여 이벤트가 발생하면 처리합니다.
- **socket()**: 클라이언트와의 연결을 위한 소켓을 생성합니다.
- **bind()**: 서버 소켓을 특정 포트에 바인딩합니다.
- **accept()**: 클라이언트 연결을 수락합니다.
- **read() / write()**: 클라이언트로부터 요청을 읽고 응답을 보냅니다.

### 2. **파일 처리 함수**

- **open()**: 파일을 열고 그 내용을 읽습니다.
- **read()**: 파일로부터 데이터를 읽어들입니다.
- **write()**: 응답을 클라이언트에 전송합니다.

## 📋 중요한 개념

### 1. **비동기 처리와 I/O 멀티플렉싱**
`poll()` 또는 `kqueue()`를 이용해 다수의 클라이언트 요청을 동시에 처리합니다. 비동기 처리를 통해 서버는 블로킹 없이 효율적으로 클라이언트의 요청을 처리할 수 있습니다.

### 2. **Nginx 유사한 설정 파일 파싱**
Nginx와 유사한 트리 구조의 설정 파일을 파싱하여 서버 설정을 동적으로 관리합니다. 이를 통해 특정 경로별로 다른 설정을 적용할 수 있습니다.

## 🧑‍🤝‍🧑 팀

저는 서버의 아키텍처 설계 및 비동기 통신 구현을 담당하였고, 다른 팀원은 HTTP 프로토콜 처리와 설정 파일 파싱을 담당했습니다.

- **비동기 I/O**: `poll()`을 사용한 I/O 멀티플렉싱을 통해 서버 성능을 최적화했습니다.
- **HTTP 요청 처리**: GET, POST, DELETE 메소드 및 HTTP/1.1 파이프라이닝을 구현했습니다.
- **설정 파일 파싱**: Nginx 스타일의 설정 파일 파싱을 구현하여 서버 설정을 동적으로 처리할 수 있게 했습니다.

## 📚 참고 자료

- [RFC 2616: Hypertext Transfer Protocol -- HTTP/1.1](https://datatracker.ietf.org/doc/html/rfc2616)
- [Nginx 공식 문서](https://nginx.org/en/docs/)
- [Kernel Queue](https://habr.com/en/articles/600123/)
