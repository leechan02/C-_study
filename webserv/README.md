<h1 align="center">
    π webserv
</h1>

<h3 align="center">
	<a href="#-about-the-project">ν”„λ΅μ νΈ μ†κ°</a>
	<span> Β· </span>
	<a href="#%EF%B8%8F-usage">μ‚¬μ©λ²•</a>
</h3>

## π“ ν”„λ΅μ νΈ μ†κ°

`webserv`λ” **HTTP/1.1** ν”„λ΅ν† μ½μ„ μ¤€μν•λ” μ›Ή μ„λ²„λ¥Ό **C++98**λ΅ κµ¬ν„ν•λ” ν”„λ΅μ νΈμ…λ‹λ‹¤. μ΄ ν”„λ΅μ νΈλ” **I/O λ©€ν‹°ν”λ ‰μ‹±**κ³Ό **λΉ„λ™κΈ° μ†μΌ“ ν†µμ‹ **μ κ°λ…μ„ λ°”νƒ•μΌλ΅ μ‹¤μ  μ›Ή μ„λ²„μ λ™μ‘ μ›λ¦¬λ¥Ό μ΄ν•΄ν•κ³  κµ¬ν„ν•λ” λ° μ¤‘μ μ„ λ‘κ³  μμµλ‹λ‹¤.

## π’΅ μ£Όμ” λ©ν‘

- **HTTP/1.1 κµ¬ν„**: GET, POST, DELETE λ©”μ†λ“ μ§€μ›
- **I/O λ©€ν‹°ν”λ ‰μ‹±**: `poll()`μ„ μ‚¬μ©ν•μ—¬ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ λ™μ‹μ— μ²λ¦¬
- **μ •μ  μ›Ήμ‚¬μ΄νΈ μ„λΉ„μ¤**: HTML νμ΄μ§€λ¥Ό μ κ³µν•λ” μ •μ  μ›Ήμ‚¬μ΄νΈ μ„λΉ„μ¤
- **λ‹¤μ¤‘ ν¬νΈ λ¦¬μ¤λ‹**: μ—¬λ¬ ν¬νΈμ—μ„ λ™μ‹ μ”μ²­ μ²λ¦¬
- **λΉ„λ™κΈ° μ†μΌ“ ν†µμ‹ **: μ†μΌ“ λΉ„λ™κΈ° μ²λ¦¬λ¥Ό ν†µν•΄ μ„λ²„ μ„±λ¥ ν–¥μƒ

## π“‚ μ£Όμ” κ°λ…

| κ°λ… | μ„¤λ… |
|:------------|:------------|
| `I/O λ©€ν‹°ν”λ ‰μ‹±` | `poll()` λλ” `kqueue()`λ¥Ό μ΄μ©ν•΄ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ λΉ„λ™κΈ°μ μΌλ΅ μ²λ¦¬ |
| `λΉ„λ™κΈ° μ†μΌ“ ν†µμ‹ ` | λΈ”λ΅ν‚Ή μ—†μ΄ λ°μ΄ν„°λ¥Ό μ†΅μμ‹ ν•μ—¬ μ„λ²„κ°€ μ—¬λ¬ μ‘μ—…μ„ λ™μ‹μ— μ²λ¦¬ν•  μ μκ² ν•¨ |
| `HTTP/1.1` | μ›Ή μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ μ²λ¦¬ν•  λ• μ‚¬μ©ν•λ” ν”„λ΅ν† μ½λ΅, μ§€μ† μ—°κ²°, νμ΄ν”„λΌμ΄λ‹, μΏ ν‚¤ λ“±μ„ μ§€μ› |
| `λΉ„λ™κΈ° μ²λ¦¬` | ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ μ²λ¦¬ν•λ” λ™μ• μ„λ²„κ°€ λΈ”λ΅ν‚Ήλμ§€ μ•κ³  λ‹¤λ¥Έ μ‘μ—…μ„ μν–‰ν•  μ μλ” κΈ°μ  |
| `Nginx μ μ‚¬ μ„¤μ •` | Nginxμ™€ μ μ‚¬ν• κµ¬μ΅°μ μ„¤μ • νμΌ νμ‹± λ° μ²λ¦¬ |

## π“ μ£Όμ” κΈ°λ¥

### 1. **λΉ„λ™κΈ° I/O λ©€ν‹°ν”λ ‰μ‹± κΈ°λ° μ•„ν‚¤ν…μ²**
`poll()`λ¥Ό μ‚¬μ©ν•΄ μ„λ²„λ” μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈ μ†μΌ“κ³Ό μ΄λ²¤νΈλ¥Ό κ°μ‹ν•λ©°, μ΄λ²¤νΈ λ°μƒ μ‹ μ²λ¦¬ν•λ” κµ¬μ΅°λ΅ μ„¤κ³„λμ—μµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ λΉ„λ™κΈ°μ μΌλ΅ λ‹¤μμ ν΄λΌμ΄μ–ΈνΈλ¥Ό ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤.

### 2. **Nginx μ¤νƒ€μΌ μ„¤μ • νμΌ**
μ„λ²„ μ„¤μ •μ€ Nginxμ™€ μ μ‚¬ν•κ² `.conf` νμΌμ„ κΈ°λ°μΌλ΅ μ΄λ£¨μ–΄μ§‘λ‹λ‹¤. μ„¤μ • νμΌμ„ νμ‹±ν•μ—¬ μ—¬λ¬ ν¬νΈ λ¦¬μ¤λ‹, λΌμ°ν…, μ—λ¬ νμ΄μ§€ μ„¤μ • λ“±μ„ μ²λ¦¬ν•©λ‹λ‹¤.

```conf
http {
    error_page 404 500 413 ./www/error/default.html;
    index index.html ;
    autoindex on;
    server {
        listen 4000;
        location / {
            alias ./www/example/;
            limit_except POST GET DELETE;
        }
        location /box/ {
            limit_except GET;
        }
    }
    server {
        listen 42;
        client_max_body_size 100;
        location / {
            alias ./www/example/;
        }
    }
}
```

### 3. **HTTP/1.1 κµ¬ν„**
GET, POST, DELETE λ©”μ†λ“ μ§€μ›κ³Ό ν•¨κ» HTTP νμ΄ν”„λΌμ΄λ‹ λ° μΏ ν‚¤ μ²λ¦¬λ¥Ό κµ¬ν„ν–μµλ‹λ‹¤.

### 4. **λ‹¤μ¤‘ ν¬νΈ λ¦¬μ¤λ‹**
μ„λ²„λ” μ—¬λ¬ ν¬νΈμ—μ„ λ™μ‹μ— λ¦¬μ¤λ‹ν•  μ μμΌλ©°, κ° ν¬νΈμ— λ€ν•΄ κ°λ³„ μ„¤μ •μ„ μ μ©ν•  μ μμµλ‹λ‹¤.

## π§  ν”„λ΅κ·Έλ¨ λ™μ‘

### 1. **ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ λ°©λ²•**

λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ—¬ `webserv`λ¥Ό μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤:

```bash
./webserv configs/example.conf
```

### 2. **μ¶λ ¥**

μ„λ²„κ°€ μ‹¤ν–‰λλ©΄ ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ μ²λ¦¬ν•λ” λ΅κ·Έκ°€ μ¶λ ¥λ©λ‹λ‹¤.

```bash
Client connected on port 4000
GET /index.html HTTP/1.1
```

## π› οΈ μ£Όμ” ν•¨μ λ° κΈ°λ¥

### 1. **ν•µμ‹¬ ν•¨μ**

- **poll()**: μ—¬λ¬ νμΌ λ””μ¤ν¬λ¦½ν„°λ¥Ό κ°μ‹ν•μ—¬ μ΄λ²¤νΈκ°€ λ°μƒν•λ©΄ μ²λ¦¬ν•©λ‹λ‹¤.
- **socket()**: ν΄λΌμ΄μ–ΈνΈμ™€μ μ—°κ²°μ„ μ„ν• μ†μΌ“μ„ μƒμ„±ν•©λ‹λ‹¤.
- **bind()**: μ„λ²„ μ†μΌ“μ„ νΉμ • ν¬νΈμ— λ°”μΈλ”©ν•©λ‹λ‹¤.
- **accept()**: ν΄λΌμ΄μ–ΈνΈ μ—°κ²°μ„ μλ½ν•©λ‹λ‹¤.
- **read() / write()**: ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μ”μ²­μ„ μ½κ³  μ‘λ‹µμ„ λ³΄λƒ…λ‹λ‹¤.

### 2. **νμΌ μ²λ¦¬ ν•¨μ**

- **open()**: νμΌμ„ μ—΄κ³  κ·Έ λ‚΄μ©μ„ μ½μµλ‹λ‹¤.
- **read()**: νμΌλ΅λ¶€ν„° λ°μ΄ν„°λ¥Ό μ½μ–΄λ“¤μ…λ‹λ‹¤.
- **write()**: μ‘λ‹µμ„ ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.

## π“‹ μ¤‘μ”ν• κ°λ…

### 1. **λΉ„λ™κΈ° μ²λ¦¬μ™€ I/O λ©€ν‹°ν”λ ‰μ‹±**
`poll()` λλ” `kqueue()`λ¥Ό μ΄μ©ν•΄ λ‹¤μμ ν΄λΌμ΄μ–ΈνΈ μ”μ²­μ„ λ™μ‹μ— μ²λ¦¬ν•©λ‹λ‹¤. λΉ„λ™κΈ° μ²λ¦¬λ¥Ό ν†µν•΄ μ„λ²„λ” λΈ”λ΅ν‚Ή μ—†μ΄ ν¨μ¨μ μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ²λ¦¬ν•  μ μμµλ‹λ‹¤.

### 2. **Nginx μ μ‚¬ν• μ„¤μ • νμΌ νμ‹±**
Nginxμ™€ μ μ‚¬ν• νΈλ¦¬ κµ¬μ΅°μ μ„¤μ • νμΌμ„ νμ‹±ν•μ—¬ μ„λ²„ μ„¤μ •μ„ λ™μ μΌλ΅ κ΄€λ¦¬ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ νΉμ • κ²½λ΅λ³„λ΅ λ‹¤λ¥Έ μ„¤μ •μ„ μ μ©ν•  μ μμµλ‹λ‹¤.

## π§‘β€π¤β€π§‘ ν€

μ €λ” μ„λ²„μ μ•„ν‚¤ν…μ² μ„¤κ³„ λ° λΉ„λ™κΈ° ν†µμ‹  κµ¬ν„μ„ λ‹΄λ‹Ήν•μ€κ³ , λ‹¤λ¥Έ ν€μ›μ€ HTTP ν”„λ΅ν† μ½ μ²λ¦¬μ™€ μ„¤μ • νμΌ νμ‹±μ„ λ‹΄λ‹Ήν–μµλ‹λ‹¤.

- **λΉ„λ™κΈ° I/O**: `poll()`μ„ μ‚¬μ©ν• I/O λ©€ν‹°ν”λ ‰μ‹±μ„ ν†µν•΄ μ„λ²„ μ„±λ¥μ„ μµμ ν™”ν–μµλ‹λ‹¤.
- **HTTP μ”μ²­ μ²λ¦¬**: GET, POST, DELETE λ©”μ†λ“ λ° HTTP/1.1 νμ΄ν”„λΌμ΄λ‹μ„ κµ¬ν„ν–μµλ‹λ‹¤.
- **μ„¤μ • νμΌ νμ‹±**: Nginx μ¤νƒ€μΌμ μ„¤μ • νμΌ νμ‹±μ„ κµ¬ν„ν•μ—¬ μ„λ²„ μ„¤μ •μ„ λ™μ μΌλ΅ μ²λ¦¬ν•  μ μκ² ν–μµλ‹λ‹¤.

## π“ μ°Έκ³  μλ£

- [RFC 2616: Hypertext Transfer Protocol -- HTTP/1.1](https://datatracker.ietf.org/doc/html/rfc2616)
- [Nginx κ³µμ‹ λ¬Έμ„](https://nginx.org/en/docs/)
- [Kernel Queue](https://habr.com/en/articles/600123/)
